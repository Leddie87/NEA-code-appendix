{% extends 'main/base.html' %}

{% block content %}
<h1>Fairs Attended Records</h1>

<p>Applications sorted by years trading (highest first)</p>

<table border="1" class="table fairs-table">
    <tr>
        <th>User</th>
        <th>Business Name</th>
        <th>Years Trading</th>
        <th>Previous Fairs</th>
        <th>Number of Previous Fairs</th>
        <th>Actions</th>
    </tr>
    <tbody>
    {% for record in fairs_records %}
    <tr {% if record.status %}
           {% if record.status.accepted %}
             class="table-success"
           {% elif record.status.denied %}
             class="table-danger"
           {% endif %}
         {% endif %}
    >
        <td>{{ record.user_id }}</td>
        <td>{{ record.buisname }}</td>
        <td>{{ record.yearstrading }}</td>
        <td>{{ record.prevfairs }}</td>
        <td>{{ record.no_prevfairs }}</td>
        <td class="align-items-end gap-2">
            <form action="{% url 'fairs' %}" method="post" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="user_id" value="{{ record.user_id }}">
                <input type="hidden" name="action" value="acceptfairs">
                <button type="submit" class="btn btn-success btn-sm">Accept</button>
            </form>
            <form action="{% url 'fairs' %}" method="post" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="user_id" value="{{ record.user_id }}">
                <input type="hidden" name="action" value="denyfairs">
                <button type="submit" class="btn btn-danger btn-sm">Deny</button>
            </form>
        </td>
    </tr>
    </tbody>
    {% empty %}
    <tr>
        <td colspan="6">No fairs attended records found.</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}